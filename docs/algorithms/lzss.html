<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>LZSS - The Hitchhiker's Guide to Compression</title> <link rel="shortcut icon" href="https://go-compression.github.io//favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://go-compression.github.io//assets/css/just-the-docs-default.css"> <script type="text/javascript" src="https://go-compression.github.io//assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://go-compression.github.io//assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>LZSS | The Hitchhiker’s Guide to Compression</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="LZSS" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A collection of resources and posts to help people understand compression algorithms." /> <meta property="og:description" content="A collection of resources and posts to help people understand compression algorithms." /> <link rel="canonical" href="https://go-compression.github.io//algorithms/lzss.html" /> <meta property="og:url" content="https://go-compression.github.io//algorithms/lzss.html" /> <meta property="og:site_name" content="The Hitchhiker’s Guide to Compression" /> <script type="application/ld+json"> {"url":"https://go-compression.github.io//algorithms/lzss.html","headline":"LZSS","@type":"WebPage","description":"A collection of resources and posts to help people understand compression algorithms.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://go-compression.github.io//" class="site-title lh-tight"> The Hitchhiker's Guide to Compression </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://go-compression.github.io//" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="https://go-compression.github.io//getting_started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://go-compression.github.io//algorithms/overview.html" class="nav-list-link">Overview of Algorithms</a><ul class="nav-list "><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://go-compression.github.io//algorithms/lz.html" class="nav-list-link">Lempel-Ziv</a><ul class="nav-list"><li class="nav-list-item active"> <a href="https://go-compression.github.io//algorithms/lzss.html" class="nav-list-link active">LZSS</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="https://go-compression.github.io//contributing.html" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="https://go-compression.github.io//reference.html" class="nav-list-link"></a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search The Hitchhiker's Guide to Compression" aria-label="Search The Hitchhiker's Guide to Compression" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/go-compression/go-compression.github.io" class="site-button" > View on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://go-compression.github.io//algorithms/overview.html">Overview of Algorithms</a></li> <li class="breadcrumb-nav-list-item"><a href="https://go-compression.github.io//algorithms/lz.html">Lempel-Ziv</a></li> <li class="breadcrumb-nav-list-item"><span>LZSS</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="lempel-ziv-storer-szymanski"> <a href="#lempel-ziv-storer-szymanski" aria-labelledby="lempel-ziv-storer-szymanski" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lempel-Ziv-Storer-Szymanski </h1> <p>Lempel-Ziv-Storer-Szymanski, which we’ll refer to as LZSS, is a simple variation of the common <a href="/algorithms/lz.html">LZ77</a> algorithm. It uses the same token concept with an offset and length to tell the decoder where to copy the text, except it only places the token when the token is shorter than the text it is replacing.</p> <p>The idea behind this is that it will never increase the size of a file by adding tokens everywhere for repeated letters. You can imagine that LZ77 would easily increase the file size if it simply encoded every repeated letter “e” or “i” as a token, which may take at least 5 bytes depending on the file and implementation.</p> <h2 id="example"> <a href="#example" aria-labelledby="example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example </h2> <p>Let’s take a look at some examples, so we can <em>see</em> exactly how it works. The <a href="https://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Storer%E2%80%93Szymanski">wikipedia article for LZSS</a> has a great example for this, which I’ll use here, and it’s worth a read as an introduction to LZSS.</p> <p>So let’s encode an exceprt of Dr. Seuss’s Green Eggs and Ham with LZSS (credit to Wikipedia for this example).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I AM SAM. I AM SAM. SAM I AM.

THAT SAM-I-AM! THAT SAM-I-AM! I DO NOT LIKE THAT SAM-I-AM!

DO WOULD YOU LIKE GREEN EGGS AND HAM?

I DO NOT LIKE THEM,SAM-I-AM.
I DO NOT LIKE GREEN EGGS AND HAM.
</code></pre></div></div> <p>This text takes up 192 bytes in a typical UTF-8 encoding. Let’s take a look at the LZSS encoded version.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I AM SAM. &lt;10,10&gt;SAM I AM.

THAT SAM-I-AM! T&lt;15,14&gt;I DO NOT LIKE&lt;29,15&gt;

DO WOULD YOU LIKE GREEN EGGS AND HAM?

I&lt;69,15&gt;EM,&lt;113,8&gt;.&lt;29,15&gt;GR&lt;64,16&gt;.
</code></pre></div></div> <p>This encoded, or compressed, version only takes 148 bytes to store (without a <a href="https://linux.die.net/man/5/magic">magic type</a> to describe the file type), which is a 77% of the original file size, or a compression ratio of 1.3. Not bad!</p> <h3 id="analysis"> <a href="#analysis" aria-labelledby="analysis" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Analysis </h3> <p>Now let’s take a second understand what’s happening before you start trying to conquer the world with LZSS.</p> <p>As we can see, the “tokens” are reducing the size of the file by referencing pieces of text that are longer than the actual token. Let’s look at the first line:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I AM SAM. &lt;10,10&gt;SAM I AM.
</code></pre></div></div> <p>The encoder works character by character. On the first character, ‘I’, it checks it’s search buffer to see if it’s already seen an ‘I’. The search buffer is essentially the encoder’s memory, for every character it encodes, it adds it into the search buffer so it can “remember” it. Because it hasn’t seen an ‘I’ already (the search buffer is empty), it just outputs an ‘I’, adds it to the search buffer, and moves to the next character. The next character is ‘ ‘ (a space). The encoder checks the search buffer to see if it’s seen a space before, and it hasn’t so it outputs the space and moves forward.</p> <p>Once it gets to the second space (after “I AM”), the LZ77 starts to come into play. It’s already seen a space before because it’s in the search buffer so it’s ready to output a token, but first it tries to maximize how much text the token is referencing. If it didn’t do this you could imagine that for every character it’s already seen it would output something similar to <code class="language-plaintext highlighter-rouge">&lt;5,1&gt;</code>, which is 5 times larger than any character. So once it finds a character that it’s already seen, it moves on to the next character and checks if it’s already seen the next character directly after the previous chracter. Once it finds a sequence of characters that it hasn’t already seen, then it goes back one character to the sequence of characters it’s already seen and prepares the token.</p> <p>Once the token is ready, the difference between LZ77 and LZSS starts to shine. At this point LZ77 simply outputs the token, adds the characters to the search buffer and continues. LZSS does something a little smarter, it will check to see if the size of the outputted token is larger than the text it’s representing. If so, it will output the text it represents, not the token, add the text to the search buffer, and continue. If not, it will output the token, add the text it represents to the search buffer and continue.</p> <p>Coming back to our example, the space character has already been seen, but a space followed by an “S” hasn’t been seen yet (“ S”), so we prepare the token representing the space. The token in our case would be “&lt;3,1&gt;”, which means go back three characters and copy 1 character(s). Next we check to see if our token is longer than our text, and “&lt;3,1&gt;” is indeed longer than “ “, so it wouldn’t make sense to output the token, so we output the space, add it to our search buffer, and continue.</p> <p>This entire process continues until we get to the “I AM SAM. “. At this point we’ve already seen an “I AM SAM. “ but haven’t seen an “I AM SAM. S” so we know our token will represent “I AM SAM. “. Then we check to see if “I AM SAM. “ is longer than “&lt;10,10&gt;”, which it is, so we output the token, add the text to our search buffer and go along.</p> <p>This process continues, encoding tokens and adding text to the search buffer character by character until it’s finished encoding everything.</p> <h3 id="takeaways"> <a href="#takeaways" aria-labelledby="takeaways" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Takeaways </h3> <p>There’s a lot of information to unpack here, but the algorithm at a high level is quite simple:</p> <ul> <li>Go character by character</li> <li>Check if it’s seen the character before <ul> <li>If so, check the next character and prepare a token to be outputted <ul> <li>If the token is longer than the text it’s representing, don’t output a token</li> <li>Add the text to the search buffer and continue</li> </ul> </li> <li>If not, add the character to the search buffer and continue</li> </ul> </li> </ul> <p>It’s important to remember that no matter the outcome, token or no token, the text is always appended to the search buffer so it can always “remember” the text it’s already seen.</p> <h2 id="implementation"> <a href="#implementation" aria-labelledby="implementation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implementation </h2> <p>Now let’s take a stab at building our very own version so we can understand it more deeply.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
